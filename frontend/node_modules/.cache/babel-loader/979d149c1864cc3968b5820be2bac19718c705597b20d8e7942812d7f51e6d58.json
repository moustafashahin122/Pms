{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\nconst initialState = {\n  tokens: {},\n  user: {},\n  full: false,\n  auth: false,\n  // updateTokensfun: {},\n  running_interval: \"\",\n  loggedin: false\n};\nexport const getTokens = createAsyncThunk(\"getTokens\", async () => {\n  const {\n    data\n  } = await axios.post(\"http://127.0.0.1:8000/auth/jwt/create/\", {\n    \"email\": \"moustafashahin122@gmail.com\",\n    \"password\": \"lovelove122@A\"\n  });\n  console.log(data);\n  // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:23 ~ getTokens ~ data:\", data);\n  return data;\n});\nexport const refreshTokens = createAsyncThunk(\"refreshTokens\", async refresh => {\n  const {\n    data\n  } = await axios.post(\"http://127.0.0.1:8000/auth/jwt/refresh/\", {\n    \"refresh\": refresh\n  });\n  state.tokens.re;\n  console.log(\"ðŸš€ ~ file: TokensSlice.jsx:33 ~ refreshTokens ~ data.access:\", data.access);\n  return data;\n});\nconst TokensSlice = createSlice({\n  name: \"Tokens\",\n  initialState,\n  reducers: {\n    setTokens: (state, action) => {\n      const {\n        access,\n        refresh\n      } = action.payload;\n      // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:34 ~ access:\", access);\n      state.tokens.access = access;\n      state.tokens.refresh = refresh;\n    },\n    getTokens: (state, action) => {\n      return state.tokens;\n    },\n    logout: (state, action) => {\n      if (state.running_interval) {\n        clearInterval(state.running_interval);\n      }\n\n      // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:34 ~ access:\", access);\n      state.tokens = {};\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:68 ~  state.tokens:\", state.tokens);\n      state.auth = false;\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:70 ~ state.auth:\", state.auth);\n      state.user = {};\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:72 ~ state.user:\", state.user);\n    },\n    setUser: (state, action) => {\n      const {\n        user_id\n      } = action.payload;\n      state.user.user_id = user_id;\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:44 ~ user_id:\", user_id);\n    },\n    updateAuth: (state, action) => {\n      state.auth = action.payload;\n    },\n    setRunningInterval: (state, action) => {\n      state.running_interval = action.payload;\n    },\n    setLoggedIn: (state, action) => {\n      state.loggedin = true;\n    },\n    setupdateTokensfun: (state, action) => {\n      state.updateTokensfun = action.payload;\n    }\n    // refreshTokens: (state) => {\n    //   state.auth ;\n\n    // },\n  },\n\n  extraReducers: builder => {\n    builder.addCase(getTokens.fulfilled, (state, action) => {\n      state.tokens = action.payload;\n      // state.tokens.access = access;\n      // state.tokens.refresh = refresh;\n      // console.log(\"dssssssssssssssssssssssssssssss\", state.tokens.access);\n      state.full = true;\n    });\n    builder.addCase(refreshTokens.fulfilled, (state, action) => {\n      state.tokens.access = action.payload.access;\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:88 ~ builder.addCase ~ action.payload.access:\", action.payload.access);\n      state.auth = true;\n      const {\n        user_id\n      } = jwt_decode(state.tokens.access);\n      state.user.user_id = user_id;\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:89 ~ builder.addCase ~ user_id:\", user_id);\n      localStorage.setItem('Tokens', JSON.stringify({\n        refresh: state.tokens.refresh,\n        access: state.tokens.access\n      }));\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:137 ~ builder.addCase ~ { refresh: state.tokens.refresh, access: state.tokens.access }:\", {\n        refresh: state.tokens.refresh,\n        access: state.tokens.access\n      });\n    });\n    builder.addCase(refreshTokens.rejected, (state, action) => {\n      alert(\"failed to refresh\");\n    });\n  }\n});\nexport const {\n  setTokens,\n  updateAuth,\n  setUser,\n  logout,\n  setupdateTokensfun,\n  setRunningInterval,\n  setLoggedIn\n} = TokensSlice.actions;\nexport default TokensSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","jwt_decode","initialState","tokens","user","full","auth","running_interval","loggedin","getTokens","data","post","console","log","refreshTokens","refresh","state","re","access","TokensSlice","name","reducers","setTokens","action","payload","logout","clearInterval","setUser","user_id","updateAuth","setRunningInterval","setLoggedIn","setupdateTokensfun","updateTokensfun","extraReducers","builder","addCase","fulfilled","localStorage","setItem","JSON","stringify","rejected","alert","actions","reducer"],"sources":["/home/shahin/GithubU/pms-iti/frontend/src/redux/slices/TokensSlice.jsx"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\n\n\n\n\nconst initialState = {\n  tokens: {},\n  user: {},\n  full: false,\n  auth: false,\n  // updateTokensfun: {},\n  running_interval: \"\",\n  loggedin: false,\n};\n\nexport const getTokens = createAsyncThunk(\"getTokens\", async () => {\n  const { data } = await axios.post(\"http://127.0.0.1:8000/auth/jwt/create/\", {\n    \"email\": \"moustafashahin122@gmail.com\",\n    \"password\": \"lovelove122@A\"\n\n  }\n  );\n  console.log(data);\n  // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:23 ~ getTokens ~ data:\", data);\n  return data;\n});\n\n\n\n\n\n\nexport const refreshTokens = createAsyncThunk(\"refreshTokens\", async (refresh) => {\n\n  const { data } = await axios.post(\"http://127.0.0.1:8000/auth/jwt/refresh/\", {\n    \"refresh\": refresh,\n  }\n  );\n  state.tokens.re\n  console.log(\"ðŸš€ ~ file: TokensSlice.jsx:33 ~ refreshTokens ~ data.access:\", data.access);\n  return data;\n\n}\n);\nconst TokensSlice = createSlice({\n  name: \"Tokens\",\n  initialState,\n  reducers: {\n\n\n    setTokens: (state, action) => {\n\n      const { access, refresh } = action.payload;\n      // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:34 ~ access:\", access);\n      state.tokens.access = access;\n      state.tokens.refresh = refresh;\n    },\n    getTokens: (state, action) => {\n\n      return state.tokens;\n    },\n    logout: (state, action) => {\n      if (state.running_interval) {\n\n\n        clearInterval(state.running_interval);\n      }\n\n      // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:34 ~ access:\", access);\n      state.tokens = {};\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:68 ~  state.tokens:\", state.tokens);\n      state.auth = false;\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:70 ~ state.auth:\", state.auth);\n      state.user = {};\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:72 ~ state.user:\", state.user);\n\n    },\n    setUser: (state, action) => {\n\n      const { user_id } = action.payload;\n      state.user.user_id = user_id;\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:44 ~ user_id:\", user_id);\n\n    },\n    updateAuth: (state, action) => {\n\n      state.auth = action.payload;\n\n\n    },\n    setRunningInterval: (state, action) => {\n\n      state.running_interval = action.payload;\n\n\n    },\n    setLoggedIn: (state, action) => {\n\n      state.loggedin = true;\n\n\n    },\n    setupdateTokensfun: (state, action) => {\n\n      state.updateTokensfun = action.payload;\n\n\n    },\n    // refreshTokens: (state) => {\n    //   state.auth ;\n\n\n    // },\n\n\n  },\n\n  extraReducers: (builder) => {\n    builder.addCase(getTokens.fulfilled, (state, action) => {\n      state.tokens = action.payload;\n      // state.tokens.access = access;\n      // state.tokens.refresh = refresh;\n      // console.log(\"dssssssssssssssssssssssssssssss\", state.tokens.access);\n      state.full = true;\n    });\n    builder.addCase(refreshTokens.fulfilled, (state, action) => {\n      state.tokens.access = action.payload.access;\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:88 ~ builder.addCase ~ action.payload.access:\", action.payload.access);\n\n\n      state.auth = true;\n      const { user_id } = jwt_decode(state.tokens.access);\n      state.user.user_id = user_id;\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:89 ~ builder.addCase ~ user_id:\", user_id);\n      localStorage.setItem('Tokens', JSON.stringify({ refresh: state.tokens.refresh, access: state.tokens.access }));\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:137 ~ builder.addCase ~ { refresh: state.tokens.refresh, access: state.tokens.access }:\", { refresh: state.tokens.refresh, access: state.tokens.access });\n\n    });\n    builder.addCase(refreshTokens.rejected, (state, action) => {\n\n      alert(\"failed to refresh\");\n    });\n  },\n});\nexport const { setTokens, updateAuth, setUser, logout, setupdateTokensfun, setRunningInterval, setLoggedIn } = TokensSlice.actions;\n\nexport default TokensSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}