{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { useDispatch } from 'react-redux';\nimport { useNavigate } from 'react-router-dom';\nimport jwt_decode from \"jwt-decode\";\nconst loginUser = async e => {\n  e.preventDefault();\n  try {\n    const response = await axios.post(\"http://127.0.0.1:8000/auth/jwt/create/\", {\n      \"email\": e.target.email.value,\n      \"password\": e.target.password.value\n    });\n    const {\n      access,\n      refresh\n    } = response.data;\n    console.log(\"ðŸš€ ~ file: LoginPage.jsx:30 ~ loginUser ~ refresh:\", refresh);\n    console.log(\"ðŸš€ ~ file: LoginPage.jsx:30 ~ loginUser ~ response:\", response);\n    if (response.status === 200) {\n      dispatch(updateAuth(true));\n      dispatch(setUser(jwt_decode(access)));\n      dispatch(setTokens({\n        access,\n        refresh\n      }));\n\n      // setAuthTokens(data);\n      // setUser(jwt_decode(data.access));\n      localStorage.setItem('Tokens', JSON.stringify(response.data));\n      console.log(\"ðŸš€ ~ file: LoginPage.jsx:39 ~ loginUser ~ response.data:\", response.data);\n      navigate('/');\n    } else {\n      alert('Something went wrong!');\n    }\n  } catch (error) {\n    alert('Something went wrong!' + error.response.status);\n  }\n};\nconst initialState = {\n  tokens: {},\n  login: loginUser,\n  user: {},\n  full: false,\n  auth: false\n};\nexport const getTokens = createAsyncThunk(\"getTokens\", async () => {\n  const {\n    data\n  } = await axios.post(\"http://127.0.0.1:8000/auth/jwt/create/\", {\n    \"email\": \"moustafashahin122@gmail.com\",\n    \"password\": \"lovelove122@A\"\n  });\n  console.log(data);\n  // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:23 ~ getTokens ~ data:\", data);\n  return data;\n});\nconst TokensSlice = createSlice({\n  name: \"Tokens\",\n  initialState,\n  reducers: {\n    setTokens: (state, action) => {\n      const {\n        access,\n        refresh\n      } = action.payload;\n      // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:34 ~ access:\", access);\n      state.tokens.access = access;\n      state.tokens.refresh = refresh;\n    },\n    setUser: (state, action) => {\n      const {\n        user_id\n      } = action.payload;\n      state.user.user_id = user_id;\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:44 ~ user_id:\", user_id);\n    },\n    updateAuth: (state, action) => {\n      state.auth = action.payload;\n    },\n    refreshTokens: (state, action) => {\n      state.auth = action.payload;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(getTokens.fulfilled, (state, action) => {\n      state.tokens = action.payload;\n      // state.tokens.access = access;\n      // state.tokens.refresh = refresh;\n      // console.log(\"dssssssssssssssssssssssssssssss\", state.tokens.access);\n      state.full = true;\n    });\n  }\n});\nexport const {\n  setTokens,\n  updateAuth,\n  setUser\n} = TokensSlice.actions;\nexport default TokensSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","useDispatch","useNavigate","jwt_decode","loginUser","e","preventDefault","response","post","target","email","value","password","access","refresh","data","console","log","status","dispatch","updateAuth","setUser","setTokens","localStorage","setItem","JSON","stringify","navigate","alert","error","initialState","tokens","login","user","full","auth","getTokens","TokensSlice","name","reducers","state","action","payload","user_id","refreshTokens","extraReducers","builder","addCase","fulfilled","actions","reducer"],"sources":["/home/shahin/GithubU/pms-iti/frontend/src/redux/slices/TokensSlice.jsx"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { useDispatch } from 'react-redux';\nimport { useNavigate } from 'react-router-dom';\nimport jwt_decode from \"jwt-decode\";\n\n\nconst loginUser = async (e) => {\n  e.preventDefault();\n\n\n  try {\n\n    const response = await axios.post(\"http://127.0.0.1:8000/auth/jwt/create/\", {\n      \"email\": e.target.email.value,\n      \"password\": e.target.password.value\n\n    }\n\n    );\n\n\n    const { access, refresh } = response.data;\n    console.log(\"ðŸš€ ~ file: LoginPage.jsx:30 ~ loginUser ~ refresh:\", refresh);\n    console.log(\"ðŸš€ ~ file: LoginPage.jsx:30 ~ loginUser ~ response:\", response);\n    if (response.status === 200) {\n      dispatch(updateAuth(true));\n      dispatch(setUser(jwt_decode(access)));\n      dispatch(setTokens({ access, refresh }));\n\n      // setAuthTokens(data);\n      // setUser(jwt_decode(data.access));\n      localStorage.setItem('Tokens', JSON.stringify(response.data));\n      console.log(\"ðŸš€ ~ file: LoginPage.jsx:39 ~ loginUser ~ response.data:\", response.data);\n      navigate('/');\n    } else {\n      alert('Something went wrong!');\n    }\n\n  } catch (error) {\n    alert('Something went wrong!' + error.response.status);\n\n  }\n\n\n};\n\n\nconst initialState = {\n  tokens: {},\n  login: loginUser,\n  user: {},\n  full: false,\n  auth: false,\n};\n\nexport const getTokens = createAsyncThunk(\"getTokens\", async () => {\n  const { data } = await axios.post(\"http://127.0.0.1:8000/auth/jwt/create/\", {\n    \"email\": \"moustafashahin122@gmail.com\",\n    \"password\": \"lovelove122@A\"\n\n  }\n  );\n  console.log(data);\n  // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:23 ~ getTokens ~ data:\", data);\n  return data;\n});\nconst TokensSlice = createSlice({\n  name: \"Tokens\",\n  initialState,\n  reducers: {\n\n\n    setTokens: (state, action) => {\n\n      const { access, refresh } = action.payload;\n      // console.log(\"ðŸš€ ~ file: TokensSlice.jsx:34 ~ access:\", access);\n      state.tokens.access = access;\n      state.tokens.refresh = refresh;\n    },\n    setUser: (state, action) => {\n\n      const { user_id } = action.payload;\n      state.user.user_id = user_id;\n      console.log(\"ðŸš€ ~ file: TokensSlice.jsx:44 ~ user_id:\", user_id);\n\n    },\n    updateAuth: (state, action) => {\n      state.auth = action.payload;\n\n\n    },\n    refreshTokens: (state, action) => {\n      state.auth = action.payload;\n\n\n    },\n\n\n  },\n\n  extraReducers: (builder) => {\n    builder.addCase(getTokens.fulfilled, (state, action) => {\n      state.tokens = action.payload;\n      // state.tokens.access = access;\n      // state.tokens.refresh = refresh;\n      // console.log(\"dssssssssssssssssssssssssssssss\", state.tokens.access);\n      state.full = true;\n    });\n  },\n});\nexport const { setTokens, updateAuth, setUser } = TokensSlice.actions;\n\nexport default TokensSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}